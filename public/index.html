<!DOCTYPE html>
<html>
<head>
  <title>Crypto Crash WebSocket Test</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #111; color: #eee; }
    .log { white-space: pre-wrap; background: #222; padding: 10px; height: 300px; overflow-y: scroll; }
    input, button { margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Crypto Crash WebSocket Client</h2>
  <div>
    <label>Player ID: </label>
    <input type="text" id="playerId" placeholder="Enter player ID" />
    <br>
    <label>Bet Amount (USD): </label>
    <input type="number" id="betAmount" />
    <button onclick="placeBet()">Place Bet</button>
    <button onclick="cashout()">Cash Out</button>
  </div>

  <h3>Game Log:</h3>
  <div class="log" id="log"></div>

   <!-- Load socket.io client from CDN -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    const log = msg => {
      const el = document.getElementById('log');
      el.innerText += `\n${msg}`;
      el.scrollTop = el.scrollHeight;
    };

    const socket = io("https://crypto-crash-backend-m4w8.onrender.com/"); 

    socket.on("connect", () => {
      log("‚úÖ Connected to WebSocket");
    });

    socket.on("game:start", data => {
      log(`üöÄ Game started! Round ID: ${data.roundId}`);
    });

    socket.on("game:multiplier", data => {
      log(`üìà Multiplier: ${data.multiplier}x`);
    });

    socket.on("game:cashout", data => {
      log(`üí∏ Player ${data.playerId} cashed out at ${data.multiplier}x, won ${data.usdAmount} USD`);
    });

    socket.on("game:end", data => {
      log(`üí• Game crashed at ${data.crashPoint}x`);
    });

    function placeBet() {
      const playerId = document.getElementById("playerId").value;
      const usd = parseFloat(document.getElementById("betAmount").value);
      socket.emit("bet:place", { playerId, usd, currency: "BTC" });
      log(`üìù Bet placed: ${usd} USD`);
    }

    function cashout() {
      const playerId = document.getElementById("playerId").value;
      socket.emit("cashout:request", { playerId });
      log("‚ö†Ô∏è Cashout requested");
    }
  </script>

</body>
</html>
